<!--
README: C2PA 可視化デモ（単一HTML / オフライン）
使い方:
  1) このファイルをブラウザで開きます。
  2) 上部のタブで「解説＆比較」「C2PA」「まとめ」を切り替えます。
  3) 左側のパネルでステップを進めると、右側の図と来歴情報が連動して変化します。
注意: これは教育用の概念実証デモです。実際のC2PA実装ではありません。
-->
<!doctype html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>C2PA 可視化デモ</title>
    <style>
        :root {
            --primary-color: #007bff;
            --secondary-color: #6c757d;
            --background-color: #f8f9fa;
            --text-color: #212529;
            --border-color: #dee2e6;
            --success-color: #28a745;
            --danger-color: #dc3545;
            --info-color: #17a2b8;
            --warning-color: #ffc107;
            --public-color: #28a745;
            --private-color: #dc3545;
            --code-bg: #e9ecef;
            --animation-duration: 0.8s;
        }
        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
            line-height: 1.6;
            color: var(--text-color);
            background-color: var(--background-color);
            margin: 0;
            padding: 20px;
            display: flex;
            flex-direction: column;
            align-items: center;
        }
        .container {
            width: 100%;
            max-width: 1200px;
            background: #fff;
            border-radius: 8px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
            overflow: hidden;
        }
        header {
            background-color: var(--primary-color);
            color: white;
            padding: 1rem;
            text-align: center;
        }
        header h1 {
            margin: 0;
            font-size: 1.8rem;
        }
        .tabs {
            display: flex;
            background-color: #f1f1f1;
            border-bottom: 1px solid var(--border-color);
        }
        .tab-button {
            background-color: inherit;
            border: none;
            outline: none;
            cursor: pointer;
            padding: 14px 16px;
            transition: 0.3s;
            font-size: 1rem;
            flex-grow: 1;
        }
        .tab-button:hover {
            background-color: #ddd;
        }
        .tab-button.active {
            background-color: #ccc;
            border-bottom: 3px solid var(--primary-color);
        }
        .tab-content {
            display: none;
            padding: 20px;
            border-top: none;
        }
        .tab-content.active {
            display: block;
        }
        .section {
            margin-bottom: 2rem;
        }
        .section h2 {
            border-bottom: 2px solid var(--primary-color);
            padding-bottom: 0.5rem;
            color: var(--primary-color);
        }
        .layout {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            align-items: start;
        }
        .control-panel {
            background-color: var(--background-color);
            padding: 1rem;
            border-radius: 8px;
            border: 1px solid var(--border-color);
        }
        .visualization {
            background-color: #fff;
            padding: 1rem;
            border-radius: 8px;
            border: 1px solid var(--border-color);
            min-height: 400px;
        }
        .button {
            background-color: var(--primary-color);
            color: white;
            border: none;
            padding: 10px 20px;
            margin: 5px;
            border-radius: 4px;
            cursor: pointer;
            font-size: 1rem;
            transition: background-color 0.3s;
        }
        .button:hover {
            background-color: #0056b3;
        }
        .button:disabled {
            background-color: var(--secondary-color);
            cursor: not-allowed;
        }
        .button.success {
            background-color: var(--success-color);
        }
        .button.danger {
            background-color: var(--danger-color);
        }
        .tag {
            display: inline-block;
            padding: 4px 8px;
            border-radius: 4px;
            font-size: 0.8rem;
            font-weight: bold;
            margin: 2px;
        }
        .tag-public {
            background-color: var(--success-color);
            color: white;
        }
        .tag-private {
            background-color: var(--danger-color);
            color: white;
        }
        .status-indicator {
            padding: 10px;
            border-radius: 4px;
            margin: 10px 0;
            font-weight: bold;
        }
        .status-success {
            background-color: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
        }
        .status-danger {
            background-color: #f8d7da;
            color: #721c24;
            border: 1px solid #f5c6cb;
        }
        .comparison-table {
            width: 100%;
            border-collapse: collapse;
            margin: 1rem 0;
        }
        .comparison-table th,
        .comparison-table td {
            border: 1px solid var(--border-color);
            padding: 12px;
            text-align: left;
        }
        .comparison-table th {
            background-color: var(--primary-color);
            color: white;
        }
        .comparison-table tr:nth-child(even) {
            background-color: var(--background-color);
        }
        .document-svg {
            width: 100%;
            height: 400px;
            border: 1px solid var(--border-color);
            border-radius: 4px;
            background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
        }
        
        .animated {
            animation-duration: var(--animation-duration);
            animation-fill-mode: both;
        }
        
        .fadeIn {
            animation-name: fadeIn;
        }
        
        .pulse {
            animation-name: pulse;
            animation-duration: 2s;
            animation-iteration-count: infinite;
        }
        
        .slideInRight {
            animation-name: slideInRight;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }
        
        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.05); }
            100% { transform: scale(1); }
        }
        
        @keyframes slideInRight {
            from {
                transform: translateX(100%);
                opacity: 0;
            }
            to {
                transform: translateX(0);
                opacity: 1;
            }
        }
        
        .security-indicator {
            display: inline-flex;
            align-items: center;
            padding: 4px 8px;
            padding-left: 24px;
            border-radius: 12px;
            font-size: 0.8rem;
            font-weight: bold;
            margin: 2px 4px;
            position: relative;
        }

        .security-indicator::before {
            position: absolute;
            left: 6px;
            top: 50%;
            transform: translateY(-50%);
        }

        .security-private {
            background-color: rgba(220, 53, 69, 0.1);
            color: var(--danger-color);
            border: 1px solid rgba(220, 53, 69, 0.3);
        }

        .security-private::before {
            content: '🔒';
        }

        .security-public {
            background-color: rgba(40, 167, 69, 0.1);
            color: var(--success-color);
            border: 1px solid rgba(40, 167, 69, 0.3);
        }

        .security-public::before {
            content: '👁️';
        }

        .security-badge rect {
            width: 24px;
            height: 24px;
            rx: 4px;
        }

        .security-badge.security-private rect {
            fill: rgba(220, 53, 69, 0.1);
            stroke: rgba(220, 53, 69, 0.3);
        }

        .security-badge.security-private text {
            fill: var(--danger-color);
        }

        .security-badge.security-public rect {
            fill: rgba(40, 167, 69, 0.1);
            stroke: rgba(40, 167, 69, 0.3);
        }

        .security-badge.security-public text {
            fill: var(--success-color);
        }
        
        .demo-progress {
            background-color: var(--background-color);
            border-radius: 8px;
            padding: 1rem;
            margin: 1rem 0;
        }
        
        .progress-bar {
            width: 100%;
            height: 8px;
            background-color: var(--border-color);
            border-radius: 4px;
            overflow: hidden;
            margin: 10px 0;
        }
        
        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, var(--primary-color), var(--info-color));
            width: 0%;
            transition: width 0.5s ease;
        }
        .provenance-info {
            background-color: var(--code-bg);
            padding: 10px;
            border-radius: 4px;
            margin: 10px 0;
            font-family: monospace;
            font-size: 0.9rem;
        }
        .step-indicator {
            display: flex;
            justify-content: space-between;
            margin: 20px 0;
        }
        .step {
            flex: 1;
            text-align: center;
            padding: 10px;
            border-radius: 4px;
            margin: 0 5px;
            background-color: var(--background-color);
            border: 2px solid var(--border-color);
        }
        .step.active {
            background-color: var(--primary-color);
            color: white;
            border-color: var(--primary-color);
        }
        .step.completed {
            background-color: var(--success-color);
            color: white;
            border-color: var(--success-color);
        }
        .explanation {
            background-color: #e7f3ff;
            border-left: 4px solid var(--info-color);
            padding: 1rem;
            margin: 1rem 0;
        }
        @media (max-width: 768px) {
            .layout {
                grid-template-columns: 1fr;
            }
            .step-indicator {
                flex-direction: column;
            }
            .step {
                margin: 5px 0;
            }
            /* 比較セクションのモバイル対応 */
            div[style*="grid-template-columns: 1fr 1fr"] {
                display: block !important;
            }
            div[style*="grid-template-columns: 1fr 1fr"] > div {
                margin-bottom: 15px !important;
            }
            /* 比較表のモバイル表示調整 */
            .comparison-table {
                font-size: 0.85rem;
            }
            .comparison-table th,
            .comparison-table td {
                padding: 8px;
            }
            /* セキュリティインジケーターのサイズ調整 */
            .security-indicator {
                font-size: 0.75rem;
                padding: 2px 6px;
                margin: 1px 2px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>C2PA 可視化デモ</h1>
            <p>「デジタル印鑑と履歴書の合体技。改ざんしたら即バレます。」</p>
        </header>

        <div class="tabs">
            <button class="tab-button active" onclick="openTab(event, 'overview')">解説＆比較</button>
            <button class="tab-button" onclick="openTab(event, 'c2pa')">C2PA</button>
            <button class="tab-button" onclick="openTab(event, 'summary')">まとめ</button>
        </div>

        <div id="overview" class="tab-content active">
            <div class="section">
                <h2>C2PA（コンテンツ真正性証明）とは</h2>
                <div class="explanation">
                    <p><span title="出所証明規格">C2PA</span>は、契約書や本人確認書類が途中で書き換えられていないかを確かめる仕組みです。</p>
                    <p>銀行で印鑑を照合する感覚で、ファイルに<span title="電子印">デジタル署名</span>を押し、いつ誰が触ったかを後から確認できます。</p>
                </div>

                <table class="comparison-table">
                    <thead>
                        <tr>
                            <th>項目</th>
                            <th>C2PA の特徴</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td><strong>何を証明するか</strong></td>
                            <td>デジタルコンテンツの「生まれ」と「変更履歴」を改ざんできない形で証明</td>
                        </tr>
                        <tr>
                            <td><strong>主な対象</strong></td>
                            <td>AI生成画像、契約書、KYC書類、報告書、証明書類</td>
                        </tr>
                        <tr>
                            <td><strong>証明の中身（直感）</strong></td>
                            <td>「デジタル印鑑＋履歴書」を暗号で保護し、偽造・改ざんを検出</td>
                        </tr>
                        <tr>
                            <td><strong>実務メリット</strong></td>
                            <td>契約書の真正性確保、KYC書類の検証、監査証跡の保全</td>
                        </tr>
                    </tbody>
                </table>

                <div class="explanation">
                    <h3>金融業界での活用例</h3>
                    <ul>
                        <li><strong>契約書管理</strong>: 電子契約の改ざん検出と来歴証明</li>
                        <li><strong>KYC書類</strong>: 本人確認書類の真正性検証</li>
                        <li><strong>監査証跡</strong>: 重要文書の作成・変更履歴の保全</li>
                        <li><strong>AI生成コンテンツ</strong>: 生成AIによる文書の出所証明</li>
                    </ul>
                </div>

                <h3>📋 C2PA vs 電子署名の比較</h3>
                
                <div style="background: linear-gradient(135deg, #f8f9fa 0%, #e3f2fd 100%); padding: 20px; border-radius: 12px; margin: 20px 0; border-left: 5px solid #2196f3;">
                    <h4 style="color: #1976d2; margin-top: 0;">🎯 一言でまとめると</h4>
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin: 15px 0;">
                        <div style="padding: 15px; background: white; border-radius: 8px; box-shadow: 0 2px 4px rgba(0,0,0,0.1);">
                            <div style="text-align: center; font-size: 2rem; margin-bottom: 10px;">🖊️</div>
                            <h5 style="color: #1976d2; text-align: center; margin: 0 0 10px 0;">電子署名</h5>
                            <p style="text-align: center; margin: 0; font-size: 0.9rem; color: #666;">「この契約書に田中太郎が確実に署名した」<br><strong>誰が署名したかを証明</strong></p>
                        </div>
                        <div style="padding: 15px; background: white; border-radius: 8px; box-shadow: 0 2px 4px rgba(0,0,0,0.1);">
                            <div style="text-align: center; font-size: 2rem; margin-bottom: 10px;">🏷️</div>
                            <h5 style="color: #1976d2; text-align: center; margin: 0 0 10px 0;">C2PA</h5>
                            <p style="text-align: center; margin: 0; font-size: 0.9rem; color: #666;">「この画像は○○で作成され、△△で編集された」<br><strong>作成から現在までの全履歴を証明</strong></p>
                        </div>
                    </div>
                </div>

                <table class="comparison-table">
                    <thead>
                        <tr>
                            <th>項目</th>
                            <th>🖊️ 電子署名</th>
                            <th>🏷️ C2PA</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td><strong>🎯 主な目的</strong></td>
                            <td><span style="color: #ff9800;">👤</span> 文書の作成者認証と改ざん検出</td>
                            <td><span style="color: #4caf50;">📍</span> コンテンツの出所証明と完全な来歴追跡</td>
                        </tr>
                        <tr>
                            <td><strong>✅ 証明できること</strong></td>
                            <td>「<strong>この人が署名した</strong>」「<strong>署名後に変更されていない</strong>」</td>
                            <td>「<strong>どこから来たか</strong>」「<strong>誰が作ったか</strong>」「<strong>どう加工されたか</strong>」</td>
                        </tr>
                        <tr>
                            <td><strong>📊 情報の詳細度</strong></td>
                            <td><span style="color: #ff9800;">📌</span> 署名者情報とハッシュ値のみ<br><small style="color: #666;">（シンプルで必要最小限）</small></td>
                            <td><span style="color: #4caf50;">📋</span> 作成ツール、編集履歴、AI使用状況など豊富なメタデータ<br><small style="color: #666;">（詳細で包括的）</small></td>
                        </tr>
                        <tr>
                            <td><strong>🤖 AI生成コンテンツ</strong></td>
                            <td><span style="color: #f44336;">❓</span> AI生成かどうかは分からない<br><small style="color: #666;">（判別不可）</small></td>
                            <td><span style="color: #4caf50;">🎯</span> AI生成であることを明示的に証明<br><small style="color: #666;">（明確に識別）</small></td>
                        </tr>
                        <tr>
                            <td><strong>📝 編集履歴</strong></td>
                            <td><span style="color: #ff9800;">⚠️</span> 署名後の変更は検出するが、履歴は残らない<br><small style="color: #666;">（変更検出のみ）</small></td>
                            <td><span style="color: #4caf50;">📈</span> 編集の各段階を記録・追跡可能<br><small style="color: #666;">（完全な履歴）</small></td>
                        </tr>
                        <tr>
                            <td><strong>📜 標準化</strong></td>
                            <td><span style="color: #2196f3;">⚖️</span> 各国の電子署名法に準拠</td>
                            <td><span style="color: #9c27b0;">🏢</span> 業界標準（Adobe、Microsoft等が策定）</td>
                        </tr>
                        <tr>
                            <td><strong>🎨 適用範囲</strong></td>
                            <td><span style="color: #ff9800;">📄</span> 主に法的文書・契約書<br><small style="color: #666;">（文書中心）</small></td>
                            <td><span style="color: #4caf50;">🌐</span> 画像、動画、文書、AI生成コンテンツ全般<br><small style="color: #666;">（全メディア対応）</small></td>
                        </tr>
                    </tbody>
                </table>

                <div class="explanation">
                    <h3>🔍 具体的な違いの例</h3>
                    
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin: 20px 0;">
                        <!-- 電子署名の例 -->
                        <div style="background: linear-gradient(135deg, #fff3e0 0%, #ffe0b2 100%); padding: 20px; border-radius: 12px; border-left: 5px solid #ff9800;">
                            <h4 style="color: #e65100; margin-top: 0; display: flex; align-items: center; gap: 8px;">
                                🖊️ 電子署名の証明内容
                            </h4>
                            <div style="background: white; padding: 15px; border-radius: 8px; margin: 10px 0; box-shadow: 0 2px 4px rgba(0,0,0,0.1);">
                                <div style="font-size: 1.1em; margin-bottom: 15px; font-weight: bold; color: #333;">📄 契約書.pdf</div>
                                <div style="display: flex; flex-direction: column; gap: 8px;">
                                    <div style="padding: 8px 12px; background: #fff3e0; border-radius: 6px; border-left: 3px solid #ff9800;">
                                        <strong>署名者:</strong> 田中太郎
                                    </div>
                                    <div style="padding: 8px 12px; background: #fff3e0; border-radius: 6px; border-left: 3px solid #ff9800;">
                                        <strong>署名日時:</strong> 2025年1月1日
                                    </div>
                                    <div style="padding: 8px 12px; background: #fff3e0; border-radius: 6px; border-left: 3px solid #ff9800;">
                                        <strong>検証結果:</strong> 署名後変更なし
                                    </div>
                                </div>
                                <div style="text-align: center; margin-top: 15px; color: #666; font-style: italic;">
                                    → シンプルで必要最小限の情報
                                </div>
                            </div>
                        </div>
                        
                        <!-- C2PAの例 -->
                        <div style="background: linear-gradient(135deg, #e8f5e8 0%, #c8e6c9 100%); padding: 20px; border-radius: 12px; border-left: 5px solid #4caf50;">
                            <h4 style="color: #2e7d32; margin-top: 0; display: flex; align-items: center; gap: 8px;">
                                🏷️ C2PAの証明内容
                            </h4>
                            <div style="background: white; padding: 15px; border-radius: 8px; margin: 10px 0; box-shadow: 0 2px 4px rgba(0,0,0,0.1);">
                                <div style="font-size: 1.1em; margin-bottom: 15px; font-weight: bold; color: #333;">🖼️ 商品画像.jpg</div>
                                <div style="display: flex; flex-direction: column; gap: 6px;">
                                    <div style="padding: 6px 10px; background: #e8f5e8; border-radius: 4px; border-left: 3px solid #4caf50; font-size: 0.9em;">
                                        <strong>撮影:</strong> Canon EOS R5, 2025/1/1 10:30
                                    </div>
                                    <div style="padding: 6px 10px; background: #e8f5e8; border-radius: 4px; border-left: 3px solid #4caf50; font-size: 0.9em;">
                                        <strong>編集:</strong> Adobe Photoshop 2024
                                    </div>
                                    <div style="padding: 6px 10px; background: #e8f5e8; border-radius: 4px; border-left: 3px solid #4caf50; font-size: 0.9em;">
                                        <strong>加工:</strong> 色調補正、シャープネス強化
                                    </div>
                                    <div style="padding: 6px 10px; background: #e8f5e8; border-radius: 4px; border-left: 3px solid #4caf50; font-size: 0.9em;">
                                        <strong>AI使用:</strong> なし（人間による編集のみ）
                                    </div>
                                    <div style="padding: 6px 10px; background: #e8f5e8; border-radius: 4px; border-left: 3px solid #4caf50; font-size: 0.9em;">
                                        <strong>署名者:</strong> フォトグラファー山田
                                    </div>
                                    <div style="padding: 6px 10px; background: #e8f5e8; border-radius: 4px; border-left: 3px solid #4caf50; font-size: 0.9em;">
                                        <strong>変更履歴:</strong> 3回の編集過程を記録
                                    </div>
                                </div>
                                <div style="text-align: center; margin-top: 15px; color: #666; font-style: italic;">
                                    → 詳細で包括的な来歴情報
                                </div>
                            </div>
                        </div>
                    </div>

                    <div style="background: #f3e5f5; padding: 20px; border-radius: 12px; margin: 20px 0; border-left: 5px solid #9c27b0;">
                        <h4 style="color: #7b1fa2; margin-top: 0;">💡 つまり、どう違うの？</h4>
                        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px; margin-top: 15px;">
                            <div style="text-align: center;">
                                <div style="font-size: 2rem; margin-bottom: 10px;">🖊️</div>
                                <div style="font-weight: bold; color: #333;">電子署名</div>
                                <div style="color: #666; font-size: 0.9em; margin-top: 5px;">「誰が署名したか」に特化<br>法的効力重視</div>
                            </div>
                            <div style="text-align: center;">
                                <div style="font-size: 2rem; margin-bottom: 10px;">🏷️</div>
                                <div style="font-weight: bold; color: #333;">C2PA</div>
                                <div style="color: #666; font-size: 0.9em; margin-top: 5px;">「どう作られたか」まで追跡<br>透明性・信頼性重視</div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div id="c2pa" class="tab-content">
            <div class="section">
                <h2>C2PA デモ: デジタル契約書の真正性証明</h2>
                
                <div class="step-indicator">
                    <div class="step" id="step1">1. 生成</div>
                    <div class="step" id="step2">2. 署名</div>
                    <div class="step" id="step3">3. 記録</div>
                    <div class="step" id="step4">4. 検証</div>
                </div>

                <div class="layout">
                    <div class="control-panel">
                        <h3>操作パネル</h3>
                        <div>
                            <button class="button" id="generateBtn" onclick="generateDocument()" title="文書本体は端末内。署名は文書に埋め込み。ハッシュのみブロックチェーンへ。">📄 契約書生成</button>
                            <button class="button" id="signBtn" onclick="signDocument()" disabled title="文書本体は端末内。署名は文書に埋め込み。ハッシュのみブロックチェーンへ。">🔏 C2PA署名</button>
                            <button class="button" id="recordBtn" onclick="recordToBlockchain()" disabled title="文書本体は端末内。署名は文書に埋め込み。ハッシュのみブロックチェーンへ。">⛓️ ブロックチェーン記録</button>
                            <button class="button" id="verifyBtn" onclick="verifyDocument()" disabled title="文書本体は端末内。署名は文書に埋め込み。ハッシュのみブロックチェーンへ。">✅ 検証実行</button>
                        </div>
                        
                        <div style="margin-top: 20px;">
                            <h4>改ざんテスト</h4>
                            <button class="button danger" id="tamperBtn" onclick="tamperDocument()" disabled>⚠️ 意図的改ざん</button>
                            <button class="button" id="verifyTamperedBtn" onclick="verifyTamperedDocument()" disabled>🔍 改ざん後検証</button>
                            <button class="button" id="restoreBtn" onclick="restoreDocument()" disabled>↩️ 改ざんを元に戻す</button>
                        </div>

                        <div class="demo-progress">
                            <h4>デモ進行状況</h4>
                            <div class="progress-bar">
                                <div class="progress-fill" id="progressFill"></div>
                            </div>
                            <div id="progressText">ステップ 0/4: 開始前</div>
                        </div>

                        <div style="margin-top: 20px;">
                            <h4>情報の公開範囲</h4>
                            <div style="margin: 10px 0;">
                                <span class="security-indicator security-private">非公開</span>
                                契約書の内容詳細
                            </div>
                            <div style="margin: 10px 0;">
                                <span class="security-indicator security-public">公開</span>
                                来歴情報・真正性証明
                            </div>
                        </div>

                        <div style="margin-top: 20px;">
                            <button class="button" onclick="resetDemo()">🔄 デモをリセット</button>
                        </div>
                    </div>

                    <div class="visualization">
                        <h3>可視化エリア</h3>
                        <svg class="document-svg" id="documentSvg" viewBox="0 0 400 350">
                            <!-- Document background -->
                            <defs>
                                <linearGradient id="docGradient" x1="0%" y1="0%" x2="100%" y2="100%">
                                    <stop offset="0%" style="stop-color:#ffffff;stop-opacity:1" />
                                    <stop offset="100%" style="stop-color:#f8f9fa;stop-opacity:1" />
                                </linearGradient>
                                <filter id="shadow" x="-20%" y="-20%" width="140%" height="140%">
                                    <feDropShadow dx="2" dy="2" stdDeviation="3" flood-color="#000000" flood-opacity="0.3"/>
                                </filter>
                            </defs>
                            
                            <!-- Main document -->
                            <rect x="30" y="30" width="280" height="220" fill="url(#docGradient)" stroke="#dee2e6" stroke-width="2" rx="8" filter="url(#shadow)"/>
                            
                            <!-- Document header -->
                            <rect x="40" y="40" width="260" height="30" fill="#007bff" rx="4"/>
                            <text x="170" y="58" text-anchor="middle" font-size="14" font-weight="bold" fill="white">デジタル契約書</text>
                            
                            <!-- Document content -->
                            <text x="50" y="90" font-size="12" font-weight="bold">契約者: 田中太郎</text>
                            <text x="50" y="110" font-size="12" id="contractAmount">金額: ¥1,000,000</text>
                            <text x="50" y="130" font-size="12">期日: 2025-12-31</text>
                            <text x="50" y="150" font-size="12">作成日: 2025-09-07</text>

                            <!-- Private content indicator -->
                            <g class="security-badge security-private" transform="translate(280,80)">
                                <rect></rect>
                                <text x="12" y="17" text-anchor="middle" font-size="14">🔒</text>
                            </g>

                            <!-- Signature area -->
                            <rect x="50" y="170" width="200" height="40" fill="none" stroke="#dee2e6" stroke-width="1" stroke-dasharray="5,5" rx="4"/>
                            <text x="150" y="192" text-anchor="middle" font-size="10" fill="#6c757d">署名エリア</text>
                            
                            <!-- C2PA Signature (initially hidden) -->
                            <g id="c2paSignature" style="display: none;" class="animated">
                                <rect x="250" y="180" width="50" height="25" fill="#007bff" rx="4"/>
                                <text x="275" y="195" text-anchor="middle" font-size="9" fill="white" font-weight="bold">C2PA</text>
                                <circle cx="275" cy="170" r="3" fill="#28a745">
                                    <animate attributeName="r" values="3;5;3" dur="2s" repeatCount="indefinite"/>
                                </circle>
                            </g>
                            
                            <!-- Blockchain Record (initially hidden) -->
                            <g id="blockchainRecord" style="display: none;" class="animated">
                                <circle cx="60" cy="230" r="18" fill="#28a745"/>
                                <text x="60" y="235" text-anchor="middle" font-size="12" fill="white">⛓️</text>
                                <circle cx="60" cy="230" r="25" fill="none" stroke="#28a745" stroke-width="2" opacity="0.5">
                                    <animate attributeName="r" values="25;30;25" dur="3s" repeatCount="indefinite"/>
                                    <animate attributeName="opacity" values="0.5;0;0.5" dur="3s" repeatCount="indefinite"/>
                                </circle>
                                <g class="security-badge security-public" transform="translate(85,210)">
                                    <rect></rect>
                                    <text x="12" y="17" text-anchor="middle" font-size="14">👁️</text>
                                </g>
                            </g>
                            
                            <!-- Verification checkmark (initially hidden) -->
                            <g id="verificationMark" style="display: none;" class="animated">
                                <circle cx="320" cy="60" r="20" fill="#28a745"/>
                                <path d="M310 60 L318 68 L330 52" stroke="white" stroke-width="3" fill="none" stroke-linecap="round"/>
                            </g>
                            
                            <!-- Tamper indicator (initially hidden) -->
                            <g id="tamperIndicator" style="display: none;" class="animated">
                                <rect x="45" y="105" width="120" height="15" fill="#dc3545" opacity="0.3" rx="2"/>
                                <text x="105" y="115" text-anchor="middle" font-size="10" fill="#dc3545" font-weight="bold">⚠️ 改ざん検出</text>
                                <circle cx="320" cy="60" r="20" fill="#dc3545"/>
                                <path d="M310 50 L330 70 M330 50 L310 70" stroke="white" stroke-width="3" stroke-linecap="round"/>
                            </g>
                            
                            <!-- Metadata visualization area -->
                            <g id="metadataViz" style="display: none;">
                                <rect x="330" y="100" width="60" height="120" fill="#e9ecef" stroke="#dee2e6" rx="4"/>
                                <text x="360" y="115" text-anchor="middle" font-size="8" font-weight="bold">メタデータ</text>
                                <rect x="335" y="120" width="50" height="3" fill="#007bff" rx="1"/>
                                <rect x="335" y="130" width="40" height="3" fill="#28a745" rx="1"/>
                                <rect x="335" y="140" width="45" height="3" fill="#17a2b8" rx="1"/>
                                <rect x="335" y="150" width="35" height="3" fill="#ffc107" rx="1"/>
                            </g>
                        </svg>

                        <div id="provenanceInfo" class="provenance-info" style="display: none;">
                            <strong>来歴情報 (Provenance):</strong><br>
                            <span id="provenanceDetails"></span>
                        </div>

                        <div id="verificationResult"></div>
                    </div>
                </div>
            </div>
        </div>

        <div id="summary" class="tab-content">
            <div class="section">
                <h2>まとめ: C2PAの価値と今後の展望</h2>
                
                <!-- 最重要ポイント -->
                <div style="background: linear-gradient(135deg, #2196f3 0%, #1976d2 100%); color: white; padding: 30px; border-radius: 16px; margin: 20px 0; text-align: center; box-shadow: 0 8px 16px rgba(33, 150, 243, 0.3);">
                    <div style="font-size: 2.5rem; margin-bottom: 15px;">🎯</div>
                    <h3 style="color: white; font-size: 1.5rem; margin: 0 0 15px 0;">C2PAの最大の価値</h3>
                    <div style="font-size: 1.3rem; font-weight: bold; margin-bottom: 10px;">「内容は秘匿、真正性は証明」</div>
                    <div style="font-size: 1rem; opacity: 0.9;">従来不可能だった2つの要件を同時に実現</div>
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin-top: 20px;">
                        <div style="background: rgba(255,255,255,0.2); padding: 15px; border-radius: 12px;">
                            <div style="font-size: 1.5rem; margin-bottom: 8px;">🔒</div>
                            <div style="font-weight: bold;">秘匿性</div>
                            <div style="font-size: 0.9rem; opacity: 0.9;">契約内容は保護</div>
                        </div>
                        <div style="background: rgba(255,255,255,0.2); padding: 15px; border-radius: 12px;">
                            <div style="font-size: 1.5rem; margin-bottom: 8px;">👁️</div>
                            <div style="font-weight: bold;">検証可能性</div>
                            <div style="font-size: 0.9rem; opacity: 0.9;">来歴は証明可能</div>
                        </div>
                    </div>
                </div>

                <!-- ビジネスインパクト -->
                <div style="background: linear-gradient(135deg, #4caf50 0%, #388e3c 100%); color: white; padding: 25px; border-radius: 16px; margin: 20px 0; box-shadow: 0 6px 12px rgba(76, 175, 80, 0.3);">
                    <div style="display: flex; align-items: center; gap: 15px; margin-bottom: 20px;">
                        <div style="font-size: 2rem;">💼</div>
                        <h3 style="color: white; margin: 0; font-size: 1.3rem;">金融業界での即効性のあるメリット</h3>
                    </div>
                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 15px;">
                        <div style="background: rgba(255,255,255,0.15); padding: 15px; border-radius: 8px;">
                            <div style="display: flex; align-items: center; gap: 10px; margin-bottom: 8px;">
                                <span style="font-size: 1.2rem;">⚖️</span>
                                <strong>規制対応</strong>
                            </div>
                            <div style="font-size: 0.9rem; opacity: 0.95;">監査時に文書の真正性を即座に証明</div>
                        </div>
                        <div style="background: rgba(255,255,255,0.15); padding: 15px; border-radius: 8px;">
                            <div style="display: flex; align-items: center; gap: 10px; margin-bottom: 8px;">
                                <span style="font-size: 1.2rem;">🛡️</span>
                                <strong>リスク管理</strong>
                            </div>
                            <div style="font-size: 0.9rem; opacity: 0.95;">改ざんされた文書による不正取引を防止</div>
                        </div>
                        <div style="background: rgba(255,255,255,0.15); padding: 15px; border-radius: 8px;">
                            <div style="display: flex; align-items: center; gap: 10px; margin-bottom: 8px;">
                                <span style="font-size: 1.2rem;">🤝</span>
                                <strong>顧客信頼</strong>
                            </div>
                            <div style="font-size: 0.9rem; opacity: 0.95;">透明性の高い文書管理で顧客満足度向上</div>
                        </div>
                        <div style="background: rgba(255,255,255,0.15); padding: 15px; border-radius: 8px;">
                            <div style="display: flex; align-items: center; gap: 10px; margin-bottom: 8px;">
                                <span style="font-size: 1.2rem;">⚡</span>
                                <strong>業務効率</strong>
                            </div>
                            <div style="font-size: 0.9rem; opacity: 0.95;">手動での真正性確認作業を自動化</div>
                        </div>
                    </div>
                </div>

                <!-- 技術的アプローチ -->
                <div class="explanation" style="background: #f8f9fa; border-left: 5px solid #6c757d; padding: 20px;">
                    <div style="display: flex; align-items: center; gap: 12px; margin-bottom: 15px;">
                        <span style="font-size: 1.8rem;">⚙️</span>
                        <h3 style="margin: 0; color: #495057;">技術的な実現方法</h3>
                    </div>
                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 12px;">
                        <div style="display: flex; align-items: center; gap: 10px; padding: 10px; background: white; border-radius: 6px; border-left: 3px solid #007bff;">
                            <span style="font-size: 1.2rem;">🖊️</span>
                            <div>
                                <strong>デジタル署名</strong><br>
                                <small style="color: #666;">作成者認証と完全性保証</small>
                            </div>
                        </div>
                        <div style="display: flex; align-items: center; gap: 10px; padding: 10px; background: white; border-radius: 6px; border-left: 3px solid #28a745;">
                            <span style="font-size: 1.2rem;">🔍</span>
                            <div>
                                <strong>ハッシュ値</strong><br>
                                <small style="color: #666;">内容変更を検出する「指紋」</small>
                            </div>
                        </div>
                        <div style="display: flex; align-items: center; gap: 10px; padding: 10px; background: white; border-radius: 6px; border-left: 3px solid #17a2b8;">
                            <span style="font-size: 1.2rem;">⛓️</span>
                            <div>
                                <strong>ブロックチェーン</strong><br>
                                <small style="color: #666;">改ざん不可能な記録保存</small>
                            </div>
                        </div>
                        <div style="display: flex; align-items: center; gap: 10px; padding: 10px; background: white; border-radius: 6px; border-left: 3px solid #ffc107;">
                            <span style="font-size: 1.2rem;">📋</span>
                            <div>
                                <strong>メタデータ</strong><br>
                                <small style="color: #666;">詳細な作成・編集履歴</small>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- キャッチフレーズ -->
                <div style="background: linear-gradient(135deg, #ff9800 0%, #f57c00 100%); color: white; padding: 25px; border-radius: 16px; margin: 20px 0; text-align: center; box-shadow: 0 6px 12px rgba(255, 152, 0, 0.3);">
                    <div style="font-size: 2rem; margin-bottom: 15px;">💡</div>
                    <div style="font-size: 1.4rem; font-weight: bold; margin-bottom: 10px;">一言で言うと</div>
                    <div style="font-size: 1.6rem; font-weight: bold; text-shadow: 2px 2px 4px rgba(0,0,0,0.3);">「デジタル印鑑と履歴書の合体技。<br>改ざんしたら即バレます。」</div>
                    <div style="font-size: 1rem; opacity: 0.9; margin-top: 15px; padding-top: 15px; border-top: 1px solid rgba(255,255,255,0.3);">
                        これにより、金融業界における文書の信頼性とコンプライアンスが大幅に向上します。
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        let currentStep = 0;
        let documentSigned = false;
        let documentRecorded = false;
        let documentTampered = false;

        function openTab(evt, tabName) {
            var i, tabcontent, tablinks;
            tabcontent = document.getElementsByClassName("tab-content");
            for (i = 0; i < tabcontent.length; i++) {
                tabcontent[i].classList.remove("active");
            }
            tablinks = document.getElementsByClassName("tab-button");
            for (i = 0; i < tablinks.length; i++) {
                tablinks[i].classList.remove("active");
            }
            document.getElementById(tabName).classList.add("active");
            evt.currentTarget.classList.add("active");
        }

        function updateProgress(step) {
            const progressFill = document.getElementById('progressFill');
            const progressText = document.getElementById('progressText');
            const percentage = (step / 4) * 100;
            
            progressFill.style.width = percentage + '%';
            
            const stepNames = [
                '開始前',
                '契約書生成完了',
                'C2PA署名完了', 
                'ブロックチェーン記録完了',
                '検証完了'
            ];
            
            progressText.textContent = `ステップ ${step}/4: ${stepNames[step]}`;
        }

        function addAnimation(element, animationClass) {
            element.classList.add('animated', animationClass);
            setTimeout(() => {
                element.classList.remove('animated', animationClass);
            }, 800);
        }

        function updateStepIndicator(step) {
            for (let i = 1; i <= 4; i++) {
                const stepElement = document.getElementById(`step${i}`);
                stepElement.classList.remove('active', 'completed');
                if (i < step) {
                    stepElement.classList.add('completed');
                } else if (i === step) {
                    stepElement.classList.add('active');
                }
            }
        }

        function generateDocument() {
            currentStep = 1;
            updateStepIndicator(1);
            updateProgress(1);
            
            document.getElementById('signBtn').disabled = false;
            document.getElementById('generateBtn').disabled = true;
            
            // Show metadata visualization
            const metadataViz = document.getElementById('metadataViz');
            metadataViz.style.display = 'block';
            addAnimation(metadataViz, 'slideInRight');
            
            const provenanceInfo = document.getElementById('provenanceInfo');
            const provenanceDetails = document.getElementById('provenanceDetails');
            
            provenanceInfo.style.display = 'block';
            addAnimation(provenanceInfo, 'fadeIn');
            
            provenanceDetails.innerHTML = `
                <strong>📄 文書生成情報:</strong><br>
                作成者: AI契約書生成システム v2.1<br>
                作成日時: ${new Date().toLocaleString('ja-JP')}<br>
                ファイル形式: PDF<br>
                ハッシュ値: sha256:a1b2c3d4e5f6...（生成中）<br>
                <span class="security-indicator security-private">内容は非公開</span>
                <span class="security-indicator security-public">メタデータは公開</span>
            `;
            
            showMessage('success', '📄 契約書を生成しました。文書本体は端末内に留まり、署名は文書に埋め込まれ、ハッシュのみがブロックチェーンへ送られます。');
        }

        function signDocument() {
            currentStep = 2;
            updateStepIndicator(2);
            updateProgress(2);
            documentSigned = true;
            
            document.getElementById('recordBtn').disabled = false;
            document.getElementById('signBtn').disabled = true;
            
            const signature = document.getElementById('c2paSignature');
            signature.style.display = 'block';
            addAnimation(signature, 'pulse');
            
            const provenanceDetails = document.getElementById('provenanceDetails');
            provenanceDetails.innerHTML += `<br><br>
                <strong>🔏 C2PA署名情報:</strong><br>
                署名者: 金融太郎 (finance-taro@example.com)<br>
                署名日時: ${new Date().toLocaleString('ja-JP')}<br>
                証明書: RSA-2048 + SHA-256<br>
                来歴チェーン: 完全<br>
                <span class="security-indicator security-public">署名は検証可能</span>
                <span class="security-indicator security-private">秘密鍵は保護</span>
            `;
            
            showMessage('success', '🔏 署名を文書に埋め込みました。文書本体は端末内にあり、ハッシュのみがブロックチェーンへ送られます。');
        }

        function recordToBlockchain() {
            currentStep = 3;
            updateStepIndicator(3);
            updateProgress(3);
            documentRecorded = true;
            
            document.getElementById('verifyBtn').disabled = false;
            document.getElementById('tamperBtn').disabled = false;
            document.getElementById('recordBtn').disabled = true;
            
            const blockchainRecord = document.getElementById('blockchainRecord');
            blockchainRecord.style.display = 'block';
            addAnimation(blockchainRecord, 'fadeIn');
            
            const provenanceDetails = document.getElementById('provenanceDetails');
            provenanceDetails.innerHTML += `<br><br>
                <strong>⛓️ ブロックチェーン記録:</strong><br>
                ネットワーク: Ethereum Testnet<br>
                ブロック番号: #18,234,567<br>
                トランザクション: 0xabc123def456...<br>
                記録日時: ${new Date().toLocaleString('ja-JP')}<br>
                <span class="security-indicator security-public">記録は公開検証可能</span>
                <span class="security-indicator security-public">改ざん不可能</span>
            `;
            
            showMessage('success', '⛓️ ハッシュのみをブロックチェーンに記録しました。文書本体は端末内で保持され、署名は文書に埋め込まれています。');
        }

        function verifyDocument() {
            currentStep = 4;
            updateStepIndicator(4);
            updateProgress(4);

            if (documentTampered) {
                const tamperIndicator = document.getElementById('tamperIndicator');
                tamperIndicator.style.display = 'block';
                addAnimation(tamperIndicator, 'pulse');

                const verificationResult = document.getElementById('verificationResult');
                verificationResult.innerHTML += `
                    <div class="status-indicator status-danger">
                        <strong>❌ 検証失敗</strong><br>
                        • C2PA署名: 無効（内容不一致）<br>
                        • ハッシュ値: 不一致<br>
                        • ブロックチェーン記録: 元の値と異なる<br>
                        • 改ざん: 検出（金額フィールド）<br>
                        <span class="security-indicator security-public">改ざんは即座に検出</span>
                    </div>
                `;
                showMessage('danger', '❌ 検証失敗: 文書が改ざんされています！');
                return;
            }
            
            const verificationMark = document.getElementById('verificationMark');
            verificationMark.style.display = 'block';
            addAnimation(verificationMark, 'fadeIn');

            const verificationResult = document.getElementById('verificationResult');
            verificationResult.innerHTML += `
                <div class="status-indicator status-success">
                    <strong>✅ 検証成功</strong><br>
                    • C2PA署名: 有効<br>
                    • ハッシュ値: 一致<br>
                    • ブロックチェーン記録: 確認済み<br>
                    • 改ざん: 検出されず<br>
                    <span class="security-indicator security-public">真正性が証明されました</span>
                </div>
            `;

            showMessage('success', '✅ 検証完了。文書本体は端末内にあり、署名は文書に埋め込まれ、ブロックチェーンにはハッシュのみが保存されていることを確認しました。');

            verificationResult.innerHTML += `
                <div class="summary-section">
                    <h3>🔁 サマリー</h3>
                    <ul>
                        <li>文書: 契約書.pdf</li>
                        <li>署名: <code>0xABCD1234EF</code>（署名ハッシュ: <code>5F2A7D9E</code>）</li>
                        <li>ハッシュ: <code>E3B0C44298FC1C149AFBF4C8996FB924</code></li>
                        <li>ブロックチェーン TxID: <code>0x1234567890ABCDEF</code></li>
                    </ul>
                </div>
            `;
        }

        function tamperDocument() {
            documentTampered = true;
            document.getElementById('verifyTamperedBtn').disabled = false;
            document.getElementById('tamperBtn').disabled = true;
            document.getElementById('restoreBtn').disabled = false;

            // Hide verification mark if it was shown
            const verificationMark = document.getElementById('verificationMark');
            verificationMark.style.display = 'none';
            
            const amountText = document.getElementById('contractAmount');
            amountText.textContent = '金額: ¥10,000,000';
            amountText.setAttribute('fill', '#dc3545');
            amountText.setAttribute('font-weight', 'bold');
            addAnimation(amountText, 'pulse');
            
            showMessage('danger', '⚠️ 契約書の金額が改ざんされました（¥1,000,000 → ¥10,000,000）');
        }

        function verifyTamperedDocument() {
            const tamperIndicator = document.getElementById('tamperIndicator');
            tamperIndicator.style.display = 'block';
            addAnimation(tamperIndicator, 'pulse');

            const verificationResult = document.getElementById('verificationResult');
            verificationResult.innerHTML += `
                <div class="status-indicator status-danger">
                    <strong>❌ 検証失敗</strong><br>
                    • C2PA署名: 無効（内容不一致）<br>
                    • ハッシュ値: 不一致<br>
                    • ブロックチェーン記録: 元の値と異なる<br>
                    • 改ざん: 検出（金額フィールド）<br>
                    <span class="security-indicator security-public">改ざんは即座に検出</span>
                </div>
            `;

            showMessage('danger', '🔍 改ざん検出: 文書の変更が即座に発見されました！');
        }

        function restoreDocument() {
            documentTampered = false;
            const amountText = document.getElementById('contractAmount');
            amountText.textContent = '金額: ¥1,000,000';
            amountText.setAttribute('fill', '#000000');
            amountText.setAttribute('font-weight', 'normal');
            const tamperIndicator = document.getElementById('tamperIndicator');
            tamperIndicator.style.display = 'none';
            document.getElementById('verifyTamperedBtn').disabled = true;
            document.getElementById('tamperBtn').disabled = false;
            document.getElementById('restoreBtn').disabled = true;
            showMessage('success', '↩️ 改ざんを元に戻しました。');
        }

        function resetDemo() {
            location.reload();
        }

        function showMessage(type, message) {
            const existingMessage = document.querySelector('.message');
            if (existingMessage) {
                existingMessage.remove();
            }
            
            const messageDiv = document.createElement('div');
            messageDiv.className = `message status-indicator status-${type}`;
            messageDiv.textContent = message;
            messageDiv.style.position = 'fixed';
            messageDiv.style.top = '20px';
            messageDiv.style.right = '20px';
            messageDiv.style.zIndex = '1000';
            messageDiv.style.maxWidth = '300px';
            
            document.body.appendChild(messageDiv);
            
            setTimeout(() => {
                messageDiv.remove();
            }, 3000);
        }

        updateStepIndicator(0);
        updateProgress(0);
    </script>
</body>
</html>
